sources:

    - name : raw
      schema: gz_raw_data

      tables:
      
        - name: sales
          identifier : raw_gz_sales
          description: sales of Greenweez / we have on row per product_id found in each orders_id
          columns:
              - name: pdt_id
                description: changed as products_id
                tests:
                  - unique
                  
              - name: orders_id
                tests:
                  - unique
          loaded_at_field: "CAST(date_date as timestamp)"
          freshness:
            warn_after:
              count: 90
              period: day
                  

        - name: product
          identifier: raw_gz_product
          columns: 
              - name: purchse_price
                description: changed as purchase_price and type to FLOAT64
              - name: products_id
                tests:
                  - unique
                  - not_null
                  
      
        - name: ship
          identifier: raw_gz_ship
          columns:  
              - name: orders_id
                tests:
                  - unique
                  - not_null
                  
                  